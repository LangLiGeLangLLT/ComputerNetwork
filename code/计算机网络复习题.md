# 计算机网络复习题

---

## 1. 简述三种交换技术

- **<font color=red>电路交换：</font>**
  面向连接，独占可靠且保证传输序列，但空闲时信道被浪费。
- **<font color=red>报文交换：</font>**
  完整存储报文后转发，无需独占整条线路，线路利用率高但对存储有要求，排队增加传输时延。
- **<font color=red>分组交换：</font>**
  在报文交换基础上规定了传输分组大小，每个分组独立转发，适合计算机数据传输的突发性。

---

## 2. 简述时延的构成

#### 总时延 = 发送时延 + 传播时延 + 处理时延 + 排队时延

- 发送时延 = 数据帧长度 / 发送速率
- 传播时延 = 信道长度 / 信号在信道的传播速度
- 处理时延 = 结点为转发处理所花费的时间
- 排队时延 = 缓存队列中分组排队所经历的时延

---

## 3. 写出频分复用、时分复用、统计时分复用、波分复用、码分复用的英文简写

- 频分复用：FDM
- 时分复用：TDM
- 统计时分复用：STDM
- 波分复用：WDM
- 码分复用：CDM

#### <font color=red>扩展：</font>

- 密集波分复用：DWDM
- 码分多址：CDMA

---

## 4. 简述数据链路层的三个主要功能

- **<font color=red>封装成帧：</font>**
  每一种链路层协议都规定了所能传送的帧的数据部分长度上限——最大传送单元 MTU。
- **<font color=red>透明传输：</font>**
  为了解决透明传输问题，具体方法是：发送端的数据链路层在<font color=red>数据中</font>出现控制字符 “SOH” 或 “EOT” 的前面插入一个转义字符 “ESC”；而在接收端的数据链路层在把数据送往网络层之前删除这个插入的转义字符。这种方法称为<font color=red>字节填充</font>或<font color=red>字符填充</font>。如果转义字符也出现在数据当中，那么仍然是在转义字符的前面插入一个转义字符。<br>
  因此，当接收端收到连续的两个转义字符时，就删去其中前面的一个。
- **<font color=red>差错检测：</font>**
  为了保证数据传输的可靠性，在数据链路层使用了<font color=red>循环冗余检验 CRC</font>。
  为了进行检错而添加的冗余码称为<font color=red>帧检验序列 FCS</font>。
  **<font color=red>（补充）CRC 是一种检错方法，而 FCS 是在添加在数据后面的冗余码。</font>**

---

## 5. 简述传统以太网中避免帧冲突的技术

#### 采用的技术：<font color=red>CSMA / CD 协议 （载波监听多点接入 / 碰撞检测 协议）</font>

- **<font color=red>多点接入：</font>**
  计算机以多点接入的方式连接在一根总线上。
- **<font color=red>载波监听：</font>**
  站点在发送之前先要检测一下总线上是否有其他计算机在发送数据，如果有，则暂时不发，以免碰撞。
- **<font color=red>碰撞检测：</font>**
  边发送数据边检测信道上的信号电压大小，当检测到信号电压摆动值超过一定的门限值时，就认为总线上至少有两个站同时在发送数据，表明产生了碰撞。
- **<font color=red>重传：</font>**
  发生碰撞之后采用<font color=red>截断二进制指数退避算法</font>决定重传时机。

---

## 6. 交换机的用途是什么？其对应的 vlan, stp 的用途和基本原理是什么？

- **<font color=red>交换机用途：</font>**
  以太网交换机是一种<font color=red>即插即用设备</font>，其内部的<font color=red>帧交换表</font>是通过<font color=red>自学习算法</font>自动地逐渐建立起来的。要转发给任何一台主机的帧，都能够很快地在交换表中找到相应的转发接口。
- **<font color=red>VLAN 用途和基本原理：</font>**
  通过在以太网帧中插入 VLAN 编号，隔离不同 VLAN 编号间的数据传输，从而<font color=red>将物理的 LAN 在逻辑上划分成多个广播域</font>以提升网络性能，增强网络安全性并便于灵活构建虚拟工作组。
- **<font color=red>STP 用途和基本原理：</font>**
  通过阻塞冗余链路，来消除二层网络中可能存在路径的回环（解决<font color=red>环路问题</font>）。当活动路径发生故障后激活冗余备份链路。

---

## 7. 简述 ARP 工作原理

#### ARP 是解决<font color=red>同一个局域网</font>上的主机或路由器的 <font color=red>IP 地址和硬件地址的映射问题</font>。

<font color=red>在主机 ARP 高速缓存中存放一个从 IP 地址到硬件地址的映射表</font>，并且这个映射表还经常动态更新。

- 当主机 A 要向本局域网上的某台主机 B 发送 IP 数据报时，就先在其 ARP 高速缓存中查看有无主机 B 的 IP 地址。如有，就在 ARP 高速缓冲中查出其对应的硬件地址，再把这个硬件地址写入 MAC 帧，然后通过局域网把该 MAC 帧发送此硬件地址。
- 也有可能查不到主机 B 的 IP 地址的项目。这可能是主机 B 才入网，也可能是主机 A 刚刚加电，其高速缓存还是空的。在这种情况下，主机 A 就自动运行 ARP，然后按以下步骤找出主机 B 的硬件地址。
  1. ARP 进程在本局域网上广播发送一个 ARP 请求分组。
  2. 在本局域网上的所有主机上运行的 ARP 进程都收到此 ARP 请求分组。
  3. 主机 B 的 IP 地址与 ARP 请求分组中要查询的 IP 地址一致，就收下这个 ARP 请求分组，并向主机 A 发送 ARP 响应分组，同时在这个 ARP 响应分组中写入自己的硬件地址。由于其余的所有主机的 IP 地址都与 ARP 请求分组中要查询的 IP 地址不一致，因此都不理睬这个 ARP 请求分组。
  4. 主机 A 收到 主机 B 的 ARP 响应分组后，就在其 ARP 高速缓存中写入主机 B 的 IP 地址到硬件地址的映射。

ARP 对保存在高速缓存中的每一个映射地址项目都设置<font color=red>生存时间</font>。凡超过生存时间的项目就从高速缓存中删除掉。

---

## 8. 掌握 IP 头部检验和计算方法
<!-- 见 2019.04.15 1 -->

####（1）发送方 IP 头部：
<table>
    <tr>
        <td>UNIT</td>
        <td>UNIT</td>
        <td>UNIT</td>
        <td>UNIT</td>
        <td>UNIT</td>
        <td>UNIT</td>
        <td>UNIT</td>
        <td>UNIT</td>
    </tr>
    <tr>
        <td align=center>4</td>
        <td align=center>5</td>
        <td colspan="2" align=center>0</td>
        <td colspan="4" align=center>28</td>
    </tr>
    <tr>
        <td colspan="4" align=center>1</td>
        <td colspan="2" align=center>0</td>
        <td colspan="2" align=center>0</td>
    </tr>
    <tr>
        <td colspan="2" align=center>4</td>
        <td colspan="2" align=center>17</td>
        <td colspan="4" align=center>首部检验和（待计算后写入）</td>
    </tr>
    <tr>
        <td colspan="8" align=center>10.12.14.5</td>
    </tr>
    <tr>
        <td colspan="8" align=center>12.6.7.9</td>
    </tr>
</table>

解：
0x4500 &emsp; [ 4, 5, 0 ]
0x001C &emsp; [ 28 ]
0x0001 &emsp; [ 1 ]
0x0000 &emsp; [ 0, 0 ]
0x0411 &emsp; [ 4, 17 ]
0x0A0C &emsp; [ 10, 12 ]
0x0E05 &emsp; [ 14, 5 ]
0x0C06 &emsp; [ 12, 6 ]
0x0709 &emsp; [ 7, 9 ]

和：0x744E = 0111 0100 0100 1110
检验和：10001011 10110001

####（2）发送方 IP 头部：
#### 0x4500, 0x0030, 0x4422, 0x4000. 0x8006, 待计算检验和，0x8C7C, 0x19AC, 0xAE24, 0x1E2B

解：
0x4500
0x0030
0x4422
0x4000
0x8006
0x0000
0x8C7C
0x19AC
0xAE24
0x1E2B

和：0x2BBCF = 0xBBD1 = 1011 1011 1101 0001
检验和：01000100 00101110

---

## 9. 掌握 IP 分片计算方法
<!-- 见 2019.04.15 2 -->

#### （1）数据 = 3800 B，IP 头 = 20 B，MTU = 1420 B，DF = 0，标识为 12345

解：
3800 / 1400 = 2
3800 % 1400 = 1000
报片总数 = 2 + 1 = 3
最后一个报片数据长度 = 1000

NULL|总长度|标识|MF|DF|片偏移
:---:|:---:|:---:|:---:|:---:|:---:
原始数据报|3820|12345|0|0|0
数据报片1|1420|12345|1|0|0 / 8 = 0
数据报片2|1420|12345|1|0|1400 / 8 = 175
数据报片3|1020|12345|0|0|2800 / 8 = 350

#### （2）第二片经过 MTU = 820 B 网络，对第二片填写下表

解：
1400 / 800 = 1
1400 % 800 = 600
子报片总数 = 1 + 1 = 2
最后一个子报片数据长度 = 600

NULL|总长度|标识|MF|DF|片偏移
:---:|:---:|:---:|:---:|:---:|:---:
数据报片2|1420|12345|1|0|175
子数据报片1|820|12345|1|0|1400 / 8 = 175
子数据报片2|620|12345|1|0|2200 / 8 = 275

---

## 10. 简述路由器在<font color=red>分类 IP 情况下</font>的分组转发算法

1. 从数据报的首部提取目的主机的 IP 地址为 D，得出目的网络地址为 N。
2. 若 N 就是与此路由器直接相连的某个网络地址，则进行直接交付，不需要再经过其他的路由器，直接把数据报交付目的主机；否则就是间接交付，执行（3）。
3. 若路由表中有目的地址为 D 的特定主机路由，则把数据报传送给路由表中所指明的下一跳路由器；否则，执行（4）。
4. 若路由表中有到达网络 N 的路由，则把数据报传送给路由表中所指明的下一跳路由器；否则，执行（5）。
5. 若路由表中有一个默认路由，则把数据报传送给路由表中所指明的默认路由器；否则，执行（6）。
6. 报告转发分组出错。

## 简述路由器在<font color=red>划分子网情况下</font>的分组转发算法

1. 从收到的数据报的首部提取目的 IP 地址 D。
2. 先判断是否为直接交付。对路由器直接相连的网络逐个进行检查：用各网络的子网掩码和 D 逐位相 “与”，看结果是否和相应的网络地址匹配。若匹配，则把分组进行直接交付，转发任务结束。否则就是间接交付，执行（3）。
3. 若路由表中有目的地址为 D 的特定主机路由，则把数据报传送给路由表中所指明的下一跳路由器；否则，执行（4）。
4. 对路由表中的每一行，用其中的子网掩码和 D 逐位相 “与”，其结果为 N。若 N 与该行的目的网络地址匹配，则把数据报传送给该行指明的下一跳路由器；否则，执行（5）。
5. 若路由表中有一个默认路由，则把数据报传送给路由表中所指明的默认路由器；否则，执行（6）。
6. 报告转发分组出错。

---

## 11. 简述路由协议的种类及特点

#### 路由协议从<font color=red>是否具有自适应</font>分为<font color=red>静态路由</font>和<font color=red>动态路由</font>两大类。
- 静态路由协议通过人工配置不能及时适应网络变化，适用于简单网络。
- 动态路由协议可以适应网络状态的变化，但需消耗额外的计算资源。

#### 动态路由协议又<font color=red>按自制系统内外</font>分为<font color=red>内部网关协议</font>和<font color=red>外部网关协议</font>两类。

##### 内部网关协议分为<font color=red>基于距离向量的 RIP</font> 和<font color=red>基于链路状态的 OSPF</font> 协议。
- RIP，以跳数作为路径评价指标，通过路由器相互交换路由表实现路由学习。
  适用于小型网络，实现简单，但开销大且收敛时间过长。
- OSPF，以跳数、带宽、时延等综合指标作为路径评价指标，通过路由器交换链路接口实现路由学习。
  适用于大型网络，实现复杂，但开销小且收敛快。

---

## 12. 掌握允许 RIP 协议的路由器获得邻居路由消息后的路由表更新计算方法
<!-- P156 或 2019.04.15 5 -->
#### （1）已知路由器 R6 有表 4-9（a）所示的路由表。现在收到相邻路由器 R4 发来的路由更新信息，如表 4-9（b）所示。试更新路由器 R6 的路由表。

##### 表 4-9（a）路由器 R6 的路由表
目的网络|距离|下一跳路由器
:---:|:---:|:---:
Net2|3|R4
Net3|4|R5

##### 表 4-9（b）R4 发来的路由更新信息
目的网络|距离|下一跳路由器
:---:|:---:|:---:
Net1|3|R1
Net2|4|R2
Net3|1|直接交付

解：
##### 表 4-9（c）修改后的表 4-9（b）
目的网络|距离|下一跳路由器
:---:|:---:|:---:
Net1|4|R4
Net2|5|R4
Net3|2|R4

##### 表 4-9（d）路由器 R6 更新后的路由表
目的网络|距离|下一跳路由器
:---:|:---:|:---:
Net1|4|R4
Net2|5|R4
Net3|2|R4

#### （2）假定 RIP 网络中的路由器 B 的路由表有如下：
目的网络|距离|下一跳路由器
:---:|:---:|:---:
N1|7|A
N2|2|C
N6|8|F
N8|4|E
N9|4|F

#### 现在 B 收到从 C 发来的路由信息：
目的网络|距离
:---:|:---:
N2|4
N3|8
N6|4
N8|3
N9|5

#### 试求出路由器 B 更新后的路由表。

解：
Temp:
目的网络|距离|下一跳路由器
:---:|:---:|:---:
N2|5|C
N3|9|C
N6|5|C
N8|4|C
N9|6|C

NewB:
目的网络|距离|下一跳路由器
:---:|:---:|:---:
N1|7|A
N2|5|C
N3|9|C
N6|5|C
N8|4|E
N9|4|F

#### 总结:
- 下一跳路由器<font color=red>相同</font>，距离<font color=red>增大则更新</font>。
- 下一跳路由器<font color=red>不同</font>，距离<font color=red>变小则更新</font>。

---

## 13. UDP 与 TCP 的对比分析

- UDP 在传送数据之前<font color=red>不需要先建立连接</font>。对方的传输层在收到 UDP 报文后，<font color=red>不需要给出确认</font>。
- 虽然 UDP <font color=red>不提供可靠交付</font>，但在某些情况下，UDP 是一种最有效的工作方式，<font color=red>支持广播 / 多播</font>。
- UDP 提供数据报服务，有边界，一次发生对应一次接收。
<br>
- TCP 则提供<font color=red>面向连接的点对点全双工传输，不提供广播或多播服务</font>。
- TCP <font color=red>通过序号、确认、超时重传、滑动窗口提供可靠传输服务</font>，增加了协议数据单元的首部，加大了网络和 CPU 的开销。
- TCP 提供流式服务，无边界，一次发送并不一定对应一次接收。有网络拥塞控制功能。

---

## 14. 最大报文段长度 MSS 的用途

- MSS <font color=red>与接收窗口无关</font>，目的是<font color=red>解决 TCP 传输效率问题</font>。
- 如果只有 1 bit 数据就发送，TCP、IP 头部占至少 40 byte，利用率为 1 / 41，还未计算链路层开销。
- 如果有很大的数据要发送，导致 IP 层分片更多，出现分片错误而重传的可能性就大。
- <font color=red>所以 MSS 使得传输在不分片的基础上尽量多传输数据以提高传输效率。</font>
- 在 TCP 连接建立过程中收发双方都填入自身支持的 MSS。
- 不过<font color=red>由于传输路径的变化</font>导致 MSS 很难确定。

---

## 15. 简述 TCP 如何实现流控（流量控制）

#### <font color=red>流量控制</font>就是<font color=red>让发送方的发送速率不要太快，要让接收方来得及接收</font>。

- 接收方发送的确认报文中的窗口字段可以用来控制发送方窗口大小，从而影响发送方的发送速率。将窗口字段设置为 0，则发送方不能发送数据。

- 利用滑动窗口机制，通过协商双方发送接收的速度，来实现流量控制。

---

## 16. 简述三种 TCP 传输机制

- **<font color=red>以字节为单位的滑动窗口机制</font>**
  TCP 对数据部分一一编号，确保每个字节的数据都是有序的。每接收到一个数据段都要返回一个确认数据段，其中确认数据号表明已经正确接收的数据段。
- **<font color=red>超时重传机制</font>**
  超时重传定时器（RTT）来发现丢失的段，发送一个数据段就会启动定时器，如果定时器过期仍然没接收到确认段，则会重新传输该段。
- **<font color=red>选择确认机制</font>**
  在 SACK 的支持下，可以只确认重传部分数据，而不重传已正确接收的数据。

---

## 17. 简述 Nagle 算法

若发送应用进程把要发送的数据逐个字节地送到 TCP 的发送缓存，则发送方把第一个数据字节先发送出去，把后面到达的数据字节都缓存起来。当发送方收到对第一个数据字符的确认后，再把发送缓存中的所有数据组装成一个报文段发送出去，同时继续对随后到达的数据进行缓存。只有在收到对前一个报文段的确认后才继续发送下一个报文段。当到达的数据已达到发送窗口大小的一半或已达到报文段的最大长度时，就立即发送一个报文段。

##### <font color=red>本质是收到确认才发送，期间数据缓存。</font>

---

## 18. 什么是糊涂窗口综合征，对应的解决办法是什么

- **<font color=red>糊涂窗口综合征：</font>**
  TCP 接收方的缓存已满，而交互式的应用进程一次只从接收缓存中读取 1 个字节（这样就使接收缓存空间仅腾出 1 个字节），然后想发送方发送确认，并把窗口设置成 1 个字节（但发送的数据报是 40 字节长）。接着，发送方又发来 1 个字节的数据（发送方发送的 IP 数据报是 41 字节长）。接收方发回确认，仍然将窗口设置为 1 个字节。这样进行下去，使网络的效率很低。
- **<font color=red>解决办法：</font>**
  让接收方等待一段时间，使得或者接收缓存已有足够空间容纳一个最大的报文段，或者等到接收缓存已有一半空闲的空间。

---

## 19. 简述 TCP 拥塞控制方法

- **<font color=red>慢开始：</font>**
  由小到大逐渐增大拥塞窗口数值。
- **<font color=red>拥塞避免：</font>**
  让拥塞窗口 cwnd 缓慢地增大，即每经过一个往返时间 RTT 就把发送方的拥塞窗口 cwnd 加 1 <font color=red>（加法增大 AI）</font>。
- **<font color=red>快重传：</font>**
  可以<font color=red>让发送方尽早知道发生了个别报文段的丢失。</font>
  发送方只要<font color=red>一连收到 3 个重复确认（3-ACK）</font>，就知道接收方确实没有收到报文段 M3，应当立即进行重传。
- **<font color=red>快恢复：</font>**
  一旦出现超时或 3 个重复确认，就要把门限值设置为当前拥塞窗口值的一半<font color=red>（乘法减小 MD）</font>。

---

## 20. 简述 TCP 建立和拆除连接过程
<!-- 见 P244 -->
- **TCP 通过<font color=red>三次握手建立连接</font>：**
  1. 主动建立连接方（通常是客户端 C）向被动建立连接方（通常是服务器 S）发送 SYN 标志的 TCP 段，表示 C => S 的连接请求。
  2. S 收到如果同意连接发 ACK 给 S，表示同意 S => C 连接。
  3. C 收到 S 的 ACK 后发 ACK 给 S 表示同意 S => C 连接。
- **TCP 通过<font color=red>四次挥手拆除连接</font>：**
  1. 主动拆除连接方（通常是客户端 C）向被动拆除连接方（通常是服务器 S）发起 FIN 标志的 TCP 段，表示 C => S 的拆除连接。
  2. S 收到后给出 ACK 确认，此后 C 不能发送但可以接收。
  3. S 发送接收后，向 C 发起 FIN 标志的 TCP 段，表示 S => C 的拆除请求。
  4. C 收到后给出 ACK 确认，并等待 2 MSL 时间后关闭连接。

---

## 21. 简述 RED 基本原理

- RED 随机早期检测是<font color=red>在网络层实施拥塞控制</font>的一种方法。
- 在路由器的输入队列中维持两个参数，即<font color=red>队列长度最小门限 THmin 和最大门限 THmax</font>。
- 当每个分组到达时，RED 就先计算平均队列长度 Lav 然后进行如下算法：
  1. 若 Lav < THmin，分组排队。
  2. 若 Lav > THmax，分组丢弃。
  3. 否则按 p 概论丢弃分组
- RED 是在检测到网络发送拥塞的早期征兆时，就以概论 p 随机丢弃个别分组。从而让拥塞控制在个别 TCP 连接上进行，避免产生全局同步。

---

## 22. 掌握 CRC 计算方法

P75

---

## 23. 掌握 IP 地址匹配计算方法

P139

---